!function(){"use strict";var e={n:function(a){var t=a&&a.__esModule?function(){return a.default}:function(){return a};return e.d(t,{a:t}),t},d:function(a,t){for(var l in t)e.o(t,l)&&!e.o(a,l)&&Object.defineProperty(a,l,{enumerable:!0,get:t[l]})},o:function(e,a){return Object.prototype.hasOwnProperty.call(e,a)}},a=window.wp.element,t=window.wp.api,l=e.n(t),o=window.wp.components,n=window.wp.i18n,i=window.wp.notices,u=window.wp.data,d=()=>{const e=(0,u.useSelect)((e=>e(i.store).getNotices().filter((e=>"snackbar"===e.type))),[]),{removeNotice:t}=(0,u.useDispatch)(i.store);return(0,a.createElement)(o.SnackbarList,{className:"edit-site-notices",notices:e,onRemove:t})};const s=buddy_vars.postTypes;class c extends a.Component{constructor(){super(...arguments),this.state={webhook:"",manualDeploy:!0,topbar:!0,manualDeployCapabilities:"",automaticDeploy:!1,automaticDeployCapabilities:"",automaticDeployPostTypes:[""],isAPILoaded:!1}}componentDidMount(){l().loadPromise.then((()=>{this.settings=new(l().models.Settings);const{isAPILoaded:e}=this.state;!1===e&&this.settings.fetch().then((e=>{this.setState({webhook:e.buddy_webhook,manualDeploy:Boolean(e.buddy_manual_deploy),topbar:Boolean(e.buddy_topbar),manualDeployCapabilities:e.buddy_manual_deploy_capabilities,automaticDeploy:Boolean(e.buddy_automatic_deploy),automaticDeployCapabilities:e.buddy_automatic_deploy_capabilities,automaticDeployPostTypes:e.buddy_automatic_deploy_post_types,isAPILoaded:!0})}))}))}render(){const{webhook:e,manualDeploy:t,topbar:i,manualDeployCapabilities:c,automaticDeploy:r,automaticDeployCapabilities:p,automaticDeployPostTypes:y,isAPILoaded:b}=this.state;return b?(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{className:"buddy-plugin__main"},(0,a.createElement)(o.Panel,null,buddy_vars.definedWebhook?(0,a.createElement)(o.PanelBody,{title:(0,n.__)("Required configuration",buddy_vars.languageSlug),icon:"admin-tools"},(0,a.createElement)("p",null,"Webhook was already defined in WP-config.")):(0,a.createElement)(o.PanelBody,{title:(0,n.__)("Required configuration",buddy_vars.languageSlug),icon:"admin-tools"},(0,a.createElement)(o.TextControl,{help:(0,n.__)("Enter your Buddy Webhook",buddy_vars.languageSlug),label:(0,n.__)("Webhook",buddy_vars.languageSlug),onChange:e=>this.setState({webhook:e}),value:e})),(0,a.createElement)(o.PanelBody,{title:(0,n.__)("Manual Deployments",buddy_vars.languageSlug),icon:"upload"},(0,a.createElement)(o.ToggleControl,{checked:t,help:(0,n.__)("Check to enable or disable manual deployments.",buddy_vars.languageSlug),label:(0,n.__)("Enable Manual Deployments",buddy_vars.languageSlug),onChange:e=>this.setState({manualDeploy:e})}),(0,a.createElement)(o.ToggleControl,{checked:i,label:(0,n.__)("Add deploy button to admin bar",buddy_vars.languageSlug),help:(0,n.__)("Adds deployment button to admin bar.",buddy_vars.languageSlug),onChange:e=>this.setState({topbar:e})}),(0,a.createElement)(o.SelectControl,{help:(0,n.__)("Pick which capability is needed to run manual deployments.",buddy_vars.languageSlug),label:(0,n.__)("Manual deployments capability",buddy_vars.languageSlug),onChange:e=>this.setState({manualDeployCapabilities:e}),options:buddy_vars.roles,value:c})),(0,a.createElement)(o.PanelBody,{title:(0,n.__)("Automatic Deployments",buddy_vars.languageSlug),icon:"controls-repeat"},(0,a.createElement)(o.ToggleControl,{checked:r,label:(0,n.__)("Enable Automatic Deployments",buddy_vars.languageSlug),help:(0,n.__)("Check to enable or disable automatic deployments.",buddy_vars.languageSlug),onChange:e=>this.setState({automaticDeploy:e})}),(0,a.createElement)("ul",null,s.map((e=>(0,a.createElement)("li",null,(0,a.createElement)(o.CheckboxControl,{className:"check_items",label:e.label,checked:y.indexOf(e.label)>-1,onChange:a=>{const t=y.indexOf(e.label);a?y.push(e.label):-1!==t&&y.splice(t,1),this.setState({automaticDeployPostTypes:y})}}))))),(0,a.createElement)(o.SelectControl,{help:(0,n.__)("Pick which capability is required to run automatic deployments.",buddy_vars.languageSlug),label:(0,n.__)("Automatic deployment capability",buddy_vars.languageSlug),onChange:e=>this.setState({automaticDeployCapabilities:e}),options:buddy_vars.roles,value:p})),(0,a.createElement)(o.Button,{isPrimary:!0,isLarge:!0,onClick:()=>{const{webhook:e,manualDeploy:a,topbar:t,manualDeployCapabilities:o,automaticDeploy:i,automaticDeployCapabilities:d}=this.state;new(l().models.Settings)({buddy_webhook:e,buddy_manual_deploy:a,buddy_topbar:t,buddy_manual_deploy_capabilities:o,buddy_automatic_deploy:i,buddy_automatic_deploy_capabilities:d,buddy_automatic_deploy_post_types:y}).save(),(0,u.dispatch)("core/notices").createNotice("success",(0,n.__)("Settings Saved",buddy_vars.languageSlug),{type:"snackbar",isDismissible:!0})}},(0,n.__)("Save",buddy_vars.languageSlug)," "))),(0,a.createElement)("div",{className:"buddy-plugin__notices"},(0,a.createElement)(d,null))):(0,a.createElement)(o.Placeholder,null,(0,a.createElement)(o.Spinner,null))}}document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("buddy-options-wrapper");e&&(0,a.render)((0,a.createElement)(c,null),e)}))}();